(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[947],{4062:(e,r,a)=>{"use strict";a.r(r),a.d(r,{default:()=>s});var t=a(7876),n=a(4232),i=a(9099),l=a(6972),o=a(870);function s(){let e=(0,i.useRouter)();(0,l.A)("supplier");let[r,a]=(0,n.useState)({title:"",origin_country:"",category:"",description:"",price_per_kg:"",image:null}),[s,d]=(0,n.useState)(""),u=e=>{let{name:r,value:t,files:n}=e.target;"image"===r&&n?a(e=>({...e,image:n[0]})):a(e=>({...e,[r]:t}))},p=async a=>{a.preventDefault(),d("");let t=new FormData;t.append("title",r.title),t.append("origin_country",r.origin_country),t.append("category",r.category),t.append("description",r.description),t.append("price_per_kg",r.price_per_kg),r.image&&t.append("image",r.image);try{await o.A.post("/products",t),e.push("/supplier/dashboard")}catch(e){var n,i;d((null==(i=e.response)||null==(n=i.data)?void 0:n.detail)||"❌ Upload failed.")}};return(0,t.jsxs)("main",{className:"min-h-screen bg-gray-50 max-w-2xl mx-auto p-6",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Upload New Product"}),s&&(0,t.jsx)("p",{className:"text-red-600 mb-4",children:s}),(0,t.jsxs)("form",{onSubmit:p,className:"space-y-4",children:[(0,t.jsx)("input",{name:"title",placeholder:"Title",onChange:u,className:"w-full border border-gray-300 p-2 rounded",required:!0}),(0,t.jsx)("input",{name:"origin_country",placeholder:"Country of Origin",onChange:u,className:"w-full border border-gray-300 p-2 rounded",required:!0}),(0,t.jsx)("input",{name:"category",placeholder:"Category (e.g. whey)",onChange:u,className:"w-full border border-gray-300 p-2 rounded",required:!0}),(0,t.jsx)("input",{name:"description",placeholder:"Description",onChange:u,className:"w-full border border-gray-300 p-2 rounded",required:!0}),(0,t.jsx)("input",{name:"price_per_kg",type:"number",step:"0.01",placeholder:"Price per KG",onChange:u,className:"w-full border border-gray-300 p-2 rounded",required:!0}),(0,t.jsx)("input",{name:"image",type:"file",accept:"image/*",onChange:u,className:"w-full",required:!0}),(0,t.jsx)("button",{type:"submit",className:"w-full bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Upload"})]})]})}},6972:(e,r,a)=>{"use strict";a.d(r,{A:()=>s});var t=a(4232),n=a(9099),i=a(870),l=a(5322);let o=["/login","/register"];function s(e){let r=(0,n.useRouter)(),{pathname:a}=r;(0,t.useEffect)(()=>{let t=(0,l.gf)();if(!t){o.includes(a)||r.replace("/login");return}i.A.defaults.headers.common.Authorization="Bearer ".concat(t),i.A.get("/auth/profile").then(t=>{let{data:n}=t,i=n.role;if(o.includes(a))switch(i){case"supplier":return r.replace("/supplier/dashboard");case"buyer":return r.replace("/buyer/dashboard");case"admin":return r.replace("/admin/dashboard")}if(e&&i!==e)return r.replace("/login")}).catch(e=>{console.error("[useAuthRedirect] token validation failed",e),(0,l.ri)(),r.replace("/login")})},[a,e,r])}},9099:(e,r,a)=>{e.exports=a(8253)},9576:(e,r,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/products/create",function(){return a(4062)}])}},e=>{var r=r=>e(e.s=r);e.O(0,[636,593,792],()=>r(9576)),_N_E=e.O()}]);