(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[589],{1209:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>c});var s=a(7876),l=a(4232),r=a(8230),d=a.n(r),n=a(870);function c(){let[e,t]=(0,l.useState)([]),[a,r]=(0,l.useState)(!0),[c,i]=(0,l.useState)(null),o=async()=>{r(!0),i(null);let e=localStorage.getItem("token");if(!e){i("Not authenticated"),r(!1);return}try{let a=await n.A.get("/deals/",{headers:{Authorization:"Bearer ".concat(e)}});t(a.data)}catch(e){var a,s;i((null==(s=e.response)||null==(a=s.data)?void 0:a.detail)||"Failed to load deals")}finally{r(!1)}},u=async(e,t)=>{let a=localStorage.getItem("token");if(!a)return void alert("Not authenticated");try{await n.A.put("/deals/".concat(e,"/status"),{status:t},{headers:{Authorization:"Bearer ".concat(a)}}),alert("Status updated to ".concat(t)),await o()}catch(e){var s,l;alert((null==(l=e.response)||null==(s=l.data)?void 0:s.detail)||"Failed to update status")}};return((0,l.useEffect)(()=>{o()},[]),a)?(0,s.jsx)("p",{className:"p-6",children:"Loading dealsâ€¦"}):c?(0,s.jsxs)("p",{className:"p-6 text-red-600",children:["Error: ",c]}):0===e.length?(0,s.jsx)("p",{className:"p-6",children:"No deals found."}):(0,s.jsxs)("main",{className:"pt-0",children:[" ",(0,s.jsxs)("div",{className:"max-w-4xl mx-auto p-4",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"My Deals"}),(0,s.jsxs)("table",{className:"min-w-full border-collapse",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"bg-gray-200",children:[(0,s.jsx)("th",{className:"border px-4 py-2",children:"ID"}),(0,s.jsx)("th",{className:"border px-4 py-2",children:"Product"}),(0,s.jsx)("th",{className:"border px-4 py-2",children:"Status"}),(0,s.jsx)("th",{className:"border px-4 py-2",children:"Created At"}),(0,s.jsx)("th",{className:"border px-4 py-2",children:"Actions"})]})}),(0,s.jsx)("tbody",{children:e.map(e=>{let t="negotiation"===e.status?"confirmed":"confirmed"===e.status?"completed":null;return(0,s.jsxs)("tr",{className:"odd:bg-white even:bg-gray-50 hover:bg-gray-100",children:[(0,s.jsx)("td",{className:"border px-4 py-2",children:e.id}),(0,s.jsx)("td",{className:"border px-4 py-2",children:e.product_title}),(0,s.jsx)("td",{className:"border px-4 py-2",children:e.status}),(0,s.jsx)("td",{className:"border px-4 py-2",children:new Date(e.created_at).toLocaleString()}),(0,s.jsxs)("td",{className:"border px-4 py-2 space-x-2",children:[t&&(0,s.jsx)("button",{className:"bg-green-500 text-white px-2 py-1 rounded",onClick:()=>u(e.id,t),children:"negotiation"===e.status?"Confirm":"Complete"}),(0,s.jsx)(d(),{href:"/deals/".concat(e.id),className:"text-blue-600 hover:underline",children:"View"})]})]},e.id)})})]})]})]})}},3357:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/deals",function(){return a(1209)}])}},e=>{var t=t=>e(e.s=t);e.O(0,[636,593,792],()=>t(3357)),_N_E=e.O()}]);