(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[787],{1484:(e,l,s)=>{"use strict";s.r(l),s.d(l,{default:()=>m});var t=s(7876),n=s(4232),a=s(9099),r=s(8230),u=s.n(r),i=s(2886),o=s(9563),d=s(870);let c=[{value:"olive_oil",label:"Olive Oil"},{value:"butter",label:"Butter"},{value:"whey_protein",label:"Whey Protein"}];function m(){let e=(0,a.useRouter)(),[l,s]=(0,n.useState)(1),[r,m]=(0,n.useState)(!1),[x,h]=(0,n.useState)(null),[p,b]=(0,n.useState)(""),[f,g]=(0,n.useState)(""),[v,y]=(0,n.useState)(""),[j,w]=(0,n.useState)(""),[N,_]=(0,n.useState)("buyer"),[C,S]=(0,n.useState)(null),[k,A]=(0,n.useState)(""),[E,P]=(0,n.useState)(""),[q,B]=(0,n.useState)(""),[O,D]=(0,n.useState)([]),[F,W]=(0,n.useState)(""),R=async()=>{try{if(!window.ethereum)throw Error("No Ethereum provider found");let e=new o.j(window.ethereum,"any");await e.send("eth_requestAccounts",[]);let l=e.getSigner(),s=await l.getAddress();S(s)}catch(e){console.error(e),alert("Wallet connection failed")}},T=async l=>{l.preventDefault(),h(null),m(!0);try{let l={name:p,email:f,password:v,role:N,wallet_address:C,business_name:k,address:E,delivery_address:q,products:O.map(e=>e.value)};"buyer"===N&&(l.monthly_spend=F),await d.A.post("/auth/register",l),e.push("/login")}catch(e){var s,t;h((null==(t=e.response)||null==(s=t.data)?void 0:s.detail)||"Registration failed"),m(!1);return}m(!1)};return(0,t.jsx)("main",{className:"pt-0 min-h-screen bg-gray-100 flex items-center justify-center px-4",children:(0,t.jsxs)("div",{className:"bg-white p-8 rounded-lg shadow-lg w-full max-w-2xl",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-center mb-6",children:"New User Activation"}),x&&(0,t.jsx)("p",{className:"text-red-600 text-center mb-4",children:x}),(0,t.jsx)("form",{onSubmit:1===l?e=>(e.preventDefault(),h(null),p&&f&&v&&j&&v===j)?C?void s(2):void h("Please connect your wallet."):void h("Please fill all fields & ensure passwords match."):T,className:"space-y-6",children:1===l?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block font-medium mb-1",children:"Full Name"}),(0,t.jsx)("input",{type:"text",value:p,onChange:e=>b(e.target.value),required:!0,className:"w-full border rounded px-3 py-2 focus:outline-none focus:ring"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block font-medium mb-1",children:"Email Address"}),(0,t.jsx)("input",{type:"email",value:f,onChange:e=>g(e.target.value),required:!0,className:"w-full border rounded px-3 py-2 focus:outline-none focus:ring"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block font-medium mb-1",children:"Password"}),(0,t.jsx)("input",{type:"password",value:v,onChange:e=>y(e.target.value),required:!0,className:"w-full border rounded px-3 py-2 focus:outline-none focus:ring"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block font-medium mb-1",children:"Confirm Password"}),(0,t.jsx)("input",{type:"password",value:j,onChange:e=>w(e.target.value),required:!0,className:"w-full border rounded px-3 py-2 focus:outline-none focus:ring"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block font-medium mb-1",children:"I am a"}),(0,t.jsxs)("select",{value:N,onChange:e=>_(e.target.value),className:"w-full border rounded px-3 py-2 focus:outline-none focus:ring",children:[(0,t.jsx)("option",{value:"buyer",children:"Buyer"}),(0,t.jsx)("option",{value:"supplier",children:"Supplier"})]})]}),(0,t.jsx)("div",{children:(0,t.jsx)("button",{type:"button",onClick:R,className:"w-full py-2 rounded text-white ".concat(C?"bg-green-600":"bg-blue-600"),children:C?"Connected: ".concat(C.slice(0,6),"…").concat(C.slice(-4)):"Connect Wallet"})}),(0,t.jsx)("div",{className:"flex justify-end",children:(0,t.jsx)("button",{type:"submit",className:"px-6 py-2 bg-green-600 text-white rounded hover:bg-green-700",children:"Next →"})})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block font-medium mb-1",children:"Business Name"}),(0,t.jsx)("input",{type:"text",value:k,onChange:e=>A(e.target.value),className:"w-full border rounded px-3 py-2 focus:outline-none focus:ring"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block font-medium mb-1",children:"Address"}),(0,t.jsx)("input",{type:"text",value:E,onChange:e=>P(e.target.value),className:"w-full border rounded px-3 py-2 focus:outline-none focus:ring"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block font-medium mb-1",children:"Delivery Address (if different)"}),(0,t.jsx)("input",{type:"text",value:q,onChange:e=>B(e.target.value),className:"w-full border rounded px-3 py-2 focus:outline-none focus:ring"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block font-medium mb-1",children:["Products you ","buyer"===N?"purchase":"sell"]}),(0,t.jsx)(i.Ay,{isMulti:!0,options:c,value:O,onChange:e=>{D([...e])},placeholder:"Select product categories…"})]}),"buyer"===N&&(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block font-medium mb-1",children:"Current monthly spend on commodities"}),(0,t.jsx)("input",{type:"text",value:F,onChange:e=>W(e.target.value),className:"w-full border rounded px-3 py-2 focus:outline-none focus:ring"})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("button",{type:"button",onClick:()=>s(1),className:"px-4 py-2 bg-gray-400 text-white rounded hover:bg-gray-500",children:"← Back"}),(0,t.jsx)("button",{type:"submit",disabled:r,className:"px-6 py-2 bg-green-600 text-white rounded hover:bg-green-700 disabled:opacity-50",children:r?"Activating…":"Activate"})]})]})}),(0,t.jsxs)("p",{className:"mt-6 text-center text-sm text-gray-600",children:["Already have an account?"," ",(0,t.jsx)(u(),{href:"/login",className:"text-blue-600 hover:underline",children:"Login"})]})]})})}},2790:(e,l,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/register",function(){return s(1484)}])}},e=>{var l=l=>e(e.s=l);e.O(0,[677,886,636,593,792],()=>l(2790)),_N_E=e.O()}]);