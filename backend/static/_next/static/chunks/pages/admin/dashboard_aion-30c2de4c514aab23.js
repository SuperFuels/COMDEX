(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[50],{4148:(e,t,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/dashboard_aion",function(){return r(4597)}])},4597:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>l});var s=r(7876),a=r(4232),n=r(6972);function l(){var e,t;(0,n.A)("admin");let[r,l]=(0,a.useState)(null),[i,c]=(0,a.useState)(""),[o,u]=(0,a.useState)(""),[d,h]=(0,a.useState)(!0),[m,p]=(0,a.useState)(!1),[f,x]=(0,a.useState)(null),g=(0,a.useRef)(null),[y,v]=(0,a.useState)(0),N=(0,a.useRef)(!1);(0,a.useLayoutEffect)(()=>{var e,t;v((null!=(t=null==(e=g.current)?void 0:e.clientWidth)?t:0)/2)},[]),(0,a.useEffect)(()=>{let e=e=>{if(!N.current||!g.current)return;let{left:t,width:r}=g.current.getBoundingClientRect(),s=e.clientX-t;v(s=Math.max(.2*r,Math.min(.8*r,s)))},t=()=>{N.current=!1};return window.addEventListener("mousemove",e),window.addEventListener("mouseup",t),()=>{window.removeEventListener("mousemove",e),window.removeEventListener("mouseup",t)}},[]),(0,a.useEffect)(()=>{let e=!0;return fetch("/api/aion/metrics").then(e=>e.json()).then(t=>e&&l(t)).catch(t=>e&&x(t.message)).finally(()=>e&&h(!1)),()=>{e=!1}},[]);let w=async()=>{if(i.trim()){p(!0),u("");try{let e=await fetch("/api/aion/query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:i.trim()})}),t=await e.json();u(t.response||"No response.")}catch(e){u("❌ Error talking to AION.")}finally{p(!1)}}};if(d)return(0,s.jsx)("div",{className:"h-screen flex items-center justify-center bg-gray-50",children:(0,s.jsx)("p",{children:"Loading AION data…"})});if(f||!r)return(0,s.jsx)("div",{className:"h-screen flex items-center justify-center bg-gray-50",children:(0,s.jsx)("p",{className:"text-red-500",children:f||"Error loading AION"})});let b=Math.max(0,(null!=(t=null==(e=g.current)?void 0:e.clientWidth)?t:0)-y);return(0,s.jsx)("div",{className:"relative flex flex-col h-screen bg-gray-50",children:(0,s.jsxs)("div",{ref:g,className:"relative flex-1 flex overflow-hidden min-h-0",children:[(0,s.jsxs)("div",{className:"bg-white p-6 overflow-auto min-w-0",style:{flexBasis:y,flexShrink:0},children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"AION Core Status"}),(0,s.jsxs)("p",{children:["Maturity Level: ",(0,s.jsx)("span",{className:"text-blue-600",children:r.maturityLevel})]}),(0,s.jsxs)("p",{children:["Memory Entries: ",(0,s.jsx)("span",{className:"text-green-600",children:r.memoryEntries})]}),(0,s.jsxs)("p",{children:["Current Emotion: ",(0,s.jsx)("span",{className:"text-purple-600",children:r.currentEmotion})]}),(0,s.jsx)("p",{className:"mt-4 text-sm text-gray-500",children:"Last Input:"}),(0,s.jsx)("p",{className:"italic text-gray-700",children:r.lastInput}),(0,s.jsx)("p",{className:"mt-2 text-sm text-gray-500",children:"Last Action:"}),(0,s.jsx)("p",{className:"italic text-gray-700",children:r.lastAction}),o&&(0,s.jsx)("div",{className:"mt-6 bg-gray-100 border border-gray-200 p-4 rounded",children:(0,s.jsx)("p",{className:"text-sm text-gray-700 whitespace-pre-line",children:o})})]}),(0,s.jsx)("div",{onMouseDown:e=>{e.preventDefault(),N.current=!0},className:"absolute top-0 h-full w-1 bg-gray-300 cursor-col-resize z-20",style:{left:y-.5}}),(0,s.jsxs)("div",{className:"bg-white p-6 overflow-auto min-w-0",style:{flexBasis:b,flexShrink:0},children:[(0,s.jsx)("textarea",{rows:6,placeholder:"Speak to AION here...",className:"w-full border border-gray-300 rounded p-3 mb-4",value:i,onChange:e=>c(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),w())}}),(0,s.jsx)("button",{onClick:w,disabled:m,className:"bg-blue-600 text-white px-4 py-2 rounded disabled:opacity-50",children:m?"Thinking…":"Send to AION"})]})]})})}},6972:(e,t,r)=>{"use strict";r.d(t,{A:()=>c});var s=r(4232),a=r(9099),n=r(870),l=r(5322);let i=["/login","/register"];function c(e){let t=(0,a.useRouter)(),{pathname:r}=t;(0,s.useEffect)(()=>{let s=(0,l.gf)();if(!s){i.includes(r)||t.replace("/login");return}n.A.defaults.headers.common.Authorization="Bearer ".concat(s),n.A.get("/auth/profile").then(s=>{let{data:a}=s,n=a.role;if(i.includes(r))switch(n){case"supplier":return t.replace("/supplier/dashboard");case"buyer":return t.replace("/buyer/dashboard");case"admin":return t.replace("/admin/dashboard")}if(e&&n!==e)return t.replace("/login")}).catch(e=>{console.error("[useAuthRedirect] token validation failed",e),(0,l.ri)(),t.replace("/login")})},[r,e,t])}},9099:(e,t,r)=>{e.exports=r(8253)}},e=>{var t=t=>e(e.s=t);e.O(0,[636,593,792],()=>t(4148)),_N_E=e.O()}]);