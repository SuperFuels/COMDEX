{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "aion://investing/schemas/company_structural_profile.schema.json",
  "title": "AION Company Structural Profile",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "company_profile_id",
    "company_ref",
    "as_of_date",
    "cost_structure",
    "geographic_exposure",
    "capital_allocation",
    "management_signals",
    "competitive_position",
    "audit"
  ],
  "properties": {
    "company_profile_id": {
      "type": "string",
      "pattern": "^company/[A-Za-z0-9._:-]+/profile/[0-9]{4}-[0-9]{2}-[0-9]{2}$"
    },

    "company_ref": {
      "type": "string",
      "pattern": "^company/"
    },

    "as_of_date": {
      "type": "string",
      "format": "date"
    },

    "cost_structure": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "labour_cost_ratio",
        "energy_cost_ratio",
        "debt_service_ratio",
        "fixed_cost_ratio",
        "variable_cost_ratio"
      ],
      "properties": {
        "labour_cost_ratio": {
          "type": "number",
          "minimum": 0,
          "maximum": 100
        },
        "energy_cost_ratio": {
          "type": "number",
          "minimum": 0,
          "maximum": 100
        },
        "debt_service_ratio": {
          "type": "number",
          "minimum": 0,
          "maximum": 100
        },
        "fixed_cost_ratio": {
          "type": "number",
          "minimum": 0,
          "maximum": 100
        },
        "variable_cost_ratio": {
          "type": "number",
          "minimum": 0,
          "maximum": 100
        },
        "commodity_input_exposure": {
          "type": "array",
          "items": {
            "type": "object",
            "additionalProperties": false,
            "required": ["name", "exposure_level"],
            "properties": {
              "name": { "type": "string", "minLength": 1 },
              "exposure_level": {
                "type": "string",
                "enum": ["low", "medium", "high", "critical"]
              },
              "hedged": { "type": "boolean" },
              "notes": { "type": "string" }
            }
          }
        },
        "cost_notes": {
          "type": "string"
        }
      }
    },

    "geographic_exposure": {
      "type": "object",
      "additionalProperties": false,
      "required": ["revenue_regions", "cost_regions"],
      "properties": {
        "revenue_regions": {
          "type": "array",
          "items": {
            "type": "object",
            "additionalProperties": false,
            "required": ["region", "share_pct"],
            "properties": {
              "region": { "type": "string", "minLength": 1 },
              "share_pct": {
                "type": "number",
                "minimum": 0,
                "maximum": 100
              },
              "currency": { "type": "string" }
            }
          }
        },
        "cost_regions": {
          "type": "array",
          "items": {
            "type": "object",
            "additionalProperties": false,
            "required": ["region", "share_pct"],
            "properties": {
              "region": { "type": "string", "minLength": 1 },
              "share_pct": {
                "type": "number",
                "minimum": 0,
                "maximum": 100
              },
              "currency": { "type": "string" }
            }
          }
        },
        "fx_sensitivity_notes": {
          "type": "string"
        }
      }
    },

    "capital_allocation": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "allocation_quality",
        "acquisition_intensity",
        "buyback_policy",
        "dividend_policy"
      ],
      "properties": {
        "allocation_quality": {
          "type": "string",
          "enum": ["disciplined", "mixed", "aggressive", "destructive", "unknown"]
        },
        "acquisition_intensity": {
          "type": "string",
          "enum": ["none", "low", "moderate", "high"]
        },
        "buyback_policy": {
          "type": "string",
          "enum": ["none", "opportunistic", "regular", "aggressive", "unknown"]
        },
        "dividend_policy": {
          "type": "string",
          "enum": ["none", "stable", "growing", "stressed", "unknown"]
        },
        "recent_acquisitions": {
          "type": "array",
          "items": {
            "type": "object",
            "additionalProperties": false,
            "required": ["target_name", "announced_date"],
            "properties": {
              "target_name": { "type": "string", "minLength": 1 },
              "announced_date": { "type": "string", "format": "date" },
              "deal_value": { "type": "number", "minimum": 0 },
              "currency": { "type": "string" },
              "rationale": { "type": "string" }
            }
          }
        },
        "capital_allocation_notes": {
          "type": "string"
        }
      }
    },

    "management_signals": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "guidance_credibility",
        "key_hire_signal",
        "departure_risk"
      ],
      "properties": {
        "guidance_credibility": {
          "type": "string",
          "enum": ["high", "medium", "low", "unknown"]
        },
        "key_hire_signal": {
          "type": "string",
          "enum": ["positive", "neutral", "negative", "unknown"]
        },
        "departure_risk": {
          "type": "string",
          "enum": ["low", "medium", "high", "unknown"]
        },
        "notable_hires": {
          "type": "array",
          "items": {
            "type": "object",
            "additionalProperties": false,
            "required": ["name", "role", "date"],
            "properties": {
              "name": { "type": "string", "minLength": 1 },
              "role": { "type": "string", "minLength": 1 },
              "date": { "type": "string", "format": "date" },
              "signal": {
                "type": "string",
                "enum": ["positive", "neutral", "negative"]
              },
              "notes": { "type": "string" }
            }
          }
        },
        "notable_departures": {
          "type": "array",
          "items": {
            "type": "object",
            "additionalProperties": false,
            "required": ["name", "role", "date"],
            "properties": {
              "name": { "type": "string", "minLength": 1 },
              "role": { "type": "string", "minLength": 1 },
              "date": { "type": "string", "format": "date" },
              "signal": {
                "type": "string",
                "enum": ["positive", "neutral", "negative"]
              },
              "notes": { "type": "string" }
            }
          }
        },
        "management_notes": {
          "type": "string"
        }
      }
    },

    "competitive_position": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "market_share_trend",
        "pricing_power",
        "competitive_pressure"
      ],
      "properties": {
        "market_share_trend": {
          "type": "string",
          "enum": ["gaining", "stable", "losing", "unknown"]
        },
        "pricing_power": {
          "type": "string",
          "enum": ["strong", "moderate", "weak", "unknown"]
        },
        "competitive_pressure": {
          "type": "string",
          "enum": ["low", "medium", "high", "extreme", "unknown"]
        },
        "main_competitors": {
          "type": "array",
          "items": { "type": "string", "minLength": 1 }
        },
        "market_share_notes": {
          "type": "string"
        }
      }
    },

    "linked_refs": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "sector_template_refs": {
          "type": "array",
          "items": {
            "type": "string",
            "pattern": "^sector/"
          }
        },
        "quarter_event_refs": {
          "type": "array",
          "items": {
            "type": "string",
            "pattern": "^company/.+/quarter/"
          }
        },
        "assessment_refs": {
          "type": "array",
          "items": {
            "type": "string",
            "pattern": "^assessment/"
          }
        }
      }
    },

    "audit": {
      "type": "object",
      "additionalProperties": false,
      "required": ["created_at", "updated_at", "created_by"],
      "properties": {
        "created_at": { "type": "string", "format": "date-time" },
        "updated_at": { "type": "string", "format": "date-time" },
        "created_by": { "type": "string" },
        "updated_by": { "type": "string" }
      }
    }
  }
}