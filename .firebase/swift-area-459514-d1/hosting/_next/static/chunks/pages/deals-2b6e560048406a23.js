(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[589],{1209:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});var s=a(7876),l=a(4232),r=a(8230),d=a.n(r);function n(){let[e,t]=(0,l.useState)([]),[a,r]=(0,l.useState)(!0),[n,c]=(0,l.useState)(null),o=()=>{r(!0),c(null);let e=localStorage.getItem("token");axios.get("http://localhost:8000/deals/",{headers:{Authorization:"Bearer ".concat(e)}}).then(e=>t(e.data)).catch(e=>{var t,a;return c((null==(a=e.response)||null==(t=a.data)?void 0:t.detail)||"Failed to load deals")}).finally(()=>r(!1))},i=(e,t)=>{let a=localStorage.getItem("token");axios.put("http://localhost:8000/deals/".concat(e,"/status"),{status:t},{headers:{Authorization:"Bearer ".concat(a)}}).then(()=>{alert("Status updated to ".concat(t)),o()}).catch(e=>{var t,a;alert((null==(a=e.response)||null==(t=a.data)?void 0:t.detail)||"Failed to update status")})};return((0,l.useEffect)(()=>{o()},[]),a)?(0,s.jsx)("p",{children:"Loading dealsâ€¦"}):n?(0,s.jsxs)("p",{className:"text-red-600",children:["Error: ",n]}):0===e.length?(0,s.jsx)("p",{children:"No deals found."}):(0,s.jsxs)("div",{className:"max-w-4xl mx-auto p-4",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"My Deals"}),(0,s.jsxs)("table",{className:"min-w-full border-collapse",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"bg-gray-200",children:[(0,s.jsx)("th",{className:"border px-4 py-2",children:"ID"}),(0,s.jsx)("th",{className:"border px-4 py-2",children:"Product"}),(0,s.jsx)("th",{className:"border px-4 py-2",children:"Status"}),(0,s.jsx)("th",{className:"border px-4 py-2",children:"Created At"}),(0,s.jsx)("th",{className:"border px-4 py-2",children:"Actions"})]})}),(0,s.jsx)("tbody",{children:e.map(e=>{let t="negotiation"===e.status?"confirmed":"confirmed"===e.status?"completed":null;return(0,s.jsxs)("tr",{className:"odd:bg-white even:bg-gray-50",children:[(0,s.jsx)("td",{className:"border px-4 py-2",children:e.id}),(0,s.jsx)("td",{className:"border px-4 py-2",children:e.product_title}),(0,s.jsx)("td",{className:"border px-4 py-2",children:e.status}),(0,s.jsx)("td",{className:"border px-4 py-2",children:new Date(e.created_at).toLocaleString()}),(0,s.jsxs)("td",{className:"border px-4 py-2",children:[t&&(0,s.jsx)("button",{className:"bg-green-500 text-white px-2 py-1 rounded mr-2",onClick:()=>i(e.id,t),children:"negotiation"===e.status?"Confirm":"Complete"}),(0,s.jsx)(d(),{href:"/deals/".concat(e.id),className:"text-blue-600 hover:underline",children:"View"})]})]},e.id)})})]})]})}},3357:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/deals",function(){return a(1209)}])}},e=>{var t=t=>e(e.s=t);e.O(0,[636,593,792],()=>t(3357)),_N_E=e.O()}]);