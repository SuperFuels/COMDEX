(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[36],{101:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var l=s(7876),a=s(4232),r=s(9765),c=s(6972),d=s(870);function i(){(0,c.A)("admin");let[e,t]=(0,a.useState)([]),[s,i]=(0,a.useState)([]),[n,o]=(0,a.useState)([]),[h,x]=(0,a.useState)(null);return(0,a.useEffect)(()=>{(async()=>{try{let[e,s,l]=await Promise.all([d.A.get("/admin/users"),d.A.get("/admin/products"),d.A.get("/admin/deals")]);t(e.data),i(s.data),o(l.data)}catch(e){console.error("❌ Error fetching admin data:",e),x("Unauthorized or failed to load admin data.")}})()},[]),(0,l.jsxs)("div",{className:"min-h-screen bg-gray-100 text-gray-900",children:[(0,l.jsx)(r.A,{}),(0,l.jsxs)("main",{className:"p-6 max-w-6xl mx-auto space-y-10",children:[(0,l.jsx)("h1",{className:"text-3xl font-bold mb-6 text-center",children:"\uD83D\uDEE0️ Admin Dashboard"}),h&&(0,l.jsx)("p",{className:"text-red-500 mb-4 text-center",children:h}),(0,l.jsxs)("section",{children:[(0,l.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"\uD83D\uDC65 All Users"}),(0,l.jsx)("div",{className:"bg-white shadow p-4 rounded overflow-x-auto",children:(0,l.jsxs)("table",{className:"min-w-full text-sm",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"text-left p-2",children:"Name"}),(0,l.jsx)("th",{className:"text-left p-2",children:"Email"}),(0,l.jsx)("th",{className:"text-left p-2",children:"Role"})]})}),(0,l.jsx)("tbody",{children:e.map(e=>(0,l.jsxs)("tr",{className:"border-t",children:[(0,l.jsx)("td",{className:"p-2",children:e.name}),(0,l.jsx)("td",{className:"p-2",children:e.email}),(0,l.jsx)("td",{className:"p-2 capitalize",children:e.role})]},e.id))})]})})]}),(0,l.jsxs)("section",{children:[(0,l.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"\uD83D\uDCE6 All Products"}),(0,l.jsx)("div",{className:"bg-white shadow p-4 rounded overflow-x-auto",children:(0,l.jsxs)("table",{className:"min-w-full text-sm",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"text-left p-2",children:"Title"}),(0,l.jsx)("th",{className:"text-left p-2",children:"Country"}),(0,l.jsx)("th",{className:"text-left p-2",children:"Category"}),(0,l.jsx)("th",{className:"text-left p-2",children:"Owner"})]})}),(0,l.jsx)("tbody",{children:s.map(e=>(0,l.jsxs)("tr",{className:"border-t",children:[(0,l.jsx)("td",{className:"p-2",children:e.title}),(0,l.jsx)("td",{className:"p-2",children:e.origin_country}),(0,l.jsx)("td",{className:"p-2",children:e.category}),(0,l.jsx)("td",{className:"p-2",children:e.owner_email})]},e.id))})]})})]}),(0,l.jsxs)("section",{children:[(0,l.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"\uD83E\uDD1D All Deals"}),(0,l.jsx)("div",{className:"bg-white shadow p-4 rounded overflow-x-auto",children:(0,l.jsxs)("table",{className:"min-w-full text-sm",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"text-left p-2",children:"Product"}),(0,l.jsx)("th",{className:"text-left p-2",children:"Buyer"}),(0,l.jsx)("th",{className:"text-left p-2",children:"Supplier"}),(0,l.jsx)("th",{className:"text-left p-2",children:"Quantity (kg)"}),(0,l.jsx)("th",{className:"text-left p-2",children:"Total Price"})]})}),(0,l.jsx)("tbody",{children:n.map(e=>(0,l.jsxs)("tr",{className:"border-t",children:[(0,l.jsx)("td",{className:"p-2",children:e.product_title}),(0,l.jsx)("td",{className:"p-2",children:e.buyer_email}),(0,l.jsx)("td",{className:"p-2",children:e.supplier_email}),(0,l.jsx)("td",{className:"p-2",children:e.quantity_kg}),(0,l.jsx)("td",{className:"p-2",children:e.total_price})]},e.id))})]})})]})]})]})}},4572:(e,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/dashboard",function(){return s(101)}])},6972:(e,t,s)=>{"use strict";s.d(t,{A:()=>c});var l=s(4232),a=s(9099),r=s(870);function c(e){let t=(0,a.useRouter)();(0,l.useEffect)(()=>{console.log("[useAuthRedirect] \uD83D\uDD0D running for route:",t.pathname);let s=localStorage.getItem("token");if(console.log("[useAuthRedirect] token:",s),!s){console.log("[useAuthRedirect] ➡️ no token, redirect to /login"),t.replace("/login");return}r.A.get("/auth/role").then(s=>{console.log("[useAuthRedirect] /auth/role →",s.status,s.data);let l=s.data.role;console.log("[useAuthRedirect] userRole:",l,"requiredRole:",e),e&&l!==e?(console.log("[useAuthRedirect] ➡️ role mismatch (have=".concat(l," need=").concat(e,"), redirect to /login")),t.replace("/login")):console.log("[useAuthRedirect] ✅ role ok, staying on page")}).catch(e=>{console.error("[useAuthRedirect] ❌ error fetching role",e),t.replace("/login")})},[e,t])}}},e=>{var t=t=>e(e.s=t);e.O(0,[636,593,792],()=>t(4572)),_N_E=e.O()}]);