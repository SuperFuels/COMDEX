(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[924],{1256:(e,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/buyer/dashboard",function(){return s(1773)}])},1773:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var a=s(7876),r=s(4232),i=s(9099),l=s(9765),c=s(2313),d=s(870);function o(){let e=(0,i.useRouter)(),[t,s]=(0,r.useState)("dealFlow"),[o,n]=(0,r.useState)([]),[u,h]=(0,r.useState)([]),[m,p]=(0,r.useState)([]),[x,g]=(0,r.useState)(!0);return((0,r.useEffect)(()=>{if(!localStorage.getItem("token"))return e.replace("/login");d.A.get("/auth/role").then(t=>{"buyer"!==t.data.role&&e.replace("/login")}).catch(()=>e.replace("/login"))},[e]),(0,r.useEffect)(()=>{(async()=>{try{let e=[];try{e=(await d.A.get("/products")).data.map(e=>({x:new Date().toLocaleTimeString(),y:e.price_per_kg}))}catch(e){console.warn("No chart series endpoint, skipping chart")}n(e);let t=await d.A.get("/deals");h(t.data);let s=await d.A.get("/products");p(s.data)}finally{g(!1)}})()},[]),x)?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsx)("p",{className:"text-gray-600",children:"Loading dashboard…"})}):(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)(l.A,{}),(0,a.jsxs)("main",{className:"p-6 max-w-7xl mx-auto",children:[(0,a.jsxs)("div",{className:"bg-white p-4 rounded shadow mb-6",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-2",children:"Live Ask Price (per tonne)"}),(0,a.jsx)(c.A,{data:o})]}),(0,a.jsx)("nav",{className:"mb-4 border-b",children:[["Deal Flow","dealFlow"],["Notifications","notifications"],["Escrow","escrow"],["Deliveries","deliveries"],["Orders","orders"],["Supplier List","supplierList"],["Available Products","products"]].map(e=>{let[r,i]=e;return(0,a.jsx)("button",{onClick:()=>s(i),className:"px-4 py-2 -mb-px ".concat(t===i?"border-b-2 border-blue-600 font-semibold":"text-gray-600 hover:text-gray-800"),children:r},i)})}),"dealFlow"===t&&(0,a.jsx)("div",{className:"bg-white p-4 rounded shadow",children:0===u.length?(0,a.jsx)("p",{className:"text-gray-500",children:"\uD83E\uDD1D No active deals."}):(0,a.jsx)("ul",{children:u.map(e=>(0,a.jsxs)("li",{className:"mb-2",children:["Deal #",e.id,": ",e.product_title," – ",e.status]},e.id))})}),"notifications"===t&&(0,a.jsx)("div",{className:"bg-white p-4 rounded shadow",children:(0,a.jsx)("p",{className:"text-gray-500",children:"\uD83D\uDD14 No notifications."})}),"escrow"===t&&(0,a.jsx)("div",{className:"bg-white p-4 rounded shadow",children:(0,a.jsx)("p",{className:"text-gray-500",children:"\uD83D\uDD12 Escrow empty."})}),"deliveries"===t&&(0,a.jsx)("div",{className:"bg-white p-4 rounded shadow",children:(0,a.jsx)("p",{className:"text-gray-500",children:"\uD83D\uDE9A No deliveries."})}),"orders"===t&&(0,a.jsx)("div",{className:"bg-white p-4 rounded shadow",children:(0,a.jsx)("p",{className:"text-gray-500",children:"\uD83D\uDCE6 No orders."})}),"supplierList"===t&&(0,a.jsx)("div",{className:"bg-white p-4 rounded shadow",children:(0,a.jsx)("p",{className:"text-gray-500",children:"\uD83C\uDFF7️ No suppliers found."})}),"products"===t&&(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:m.map(t=>(0,a.jsxs)("div",{className:"bg-white p-4 rounded shadow flex flex-col",children:[(0,a.jsx)("img",{src:"".concat("https://comdex-api-test-375760843948.us-central1.run.app").concat(t.image_url),alt:t.title,className:"h-40 w-full object-cover rounded mb-2",onError:e=>{e.target.src="/placeholder.jpg"}}),(0,a.jsx)("h2",{className:"text-lg font-semibold",children:t.title}),(0,a.jsx)("p",{className:"text-sm text-gray-700 mt-1",children:t.description}),(0,a.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:t.origin_country}),(0,a.jsxs)("p",{className:"text-lg font-bold mt-2",children:["$",t.price_per_kg,"/kg"]}),(0,a.jsx)("button",{onClick:()=>e.push("/deals/create/".concat(t.id)),className:"mt-auto bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700",children:"Contact Supplier"})]},t.id))})]})]})}},2313:(e,t,s)=>{"use strict";s.d(t,{A:()=>n});var a=s(7876);s(4232);var r=s(252),i=s(5561),l=s(2333),c=s(4354),d=s(1874),o=s(8834);function n(e){let{data:t,height:s=200}=e,n=t.map(e=>({time:new Date(1e3*e.time).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),value:e.value}));return(0,a.jsx)(r.u,{width:"100%",height:s,children:(0,a.jsxs)(i.b,{data:n,children:[(0,a.jsx)(l.W,{dataKey:"time",tick:{fontSize:12}}),(0,a.jsx)(c.h,{tick:{fontSize:12}}),(0,a.jsx)(d.m,{labelFormatter:e=>"Time: ".concat(e),formatter:e=>e.toFixed(2)}),(0,a.jsx)(o.N,{type:"monotone",dataKey:"value",stroke:"#4A90E2",strokeWidth:2,dot:!1})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[60,636,593,792],()=>t(1256)),_N_E=e.O()}]);